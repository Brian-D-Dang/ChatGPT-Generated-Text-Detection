Not sure if it's the same for terrestrial stations, I used to work for a pay TV company. For us, each station is controlled by a programming team who decides the line-up which is basically a list of which programme goes into which time-slot so yeah, everything is pretty much automated at the time of airing. Most programmes are already filmed with advertising slots in mind which is why half hour programmes tend to have a 20 minute run time instead of 30 minutes and one hour programmes around 45 minutes or less. The programming team then allocates the ad slots in the middle of the programmes and just sorta fills in the spaces with the ads. In the event that there aren't enough ads to fill in the spaces they will allocate like in channel promos and stuff. Hope that helps)